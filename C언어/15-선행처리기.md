# 선행처리기

## 1. 선행처리기
선행처리기란 컴파일러가 소스 프로그램을 기계어 코드로 번역하기 전에 일련의 작업을 수행하는 것이다.

선행처리기를 사용하는 목적은 프로그램을 쉽게 수정하고 이식성을 높이기 위함이다.

선행처리기는 지정된 선행처리기 명령어를 해석하여 변환한 결과를 소스 프로그램에 추가한다.

대표적인 선행처리기 명령에는 다른 파일을 포함하는 #include문, 메크로 기능을 하는 #define문이 있다.

### 선행처리기의 특징과 장점
선행처리기의 특징

1. '#'으로 시작한다.

2. 세미콜론(;)을 사용하지 않는다.

3. C언어 문법과 키워드에 영향을 받지 않는다.

선행처리기의 장점

1. 프로그램을 이해하기 쉽다.

2. 프로그램을 수정하기 쉽다.

3. 프로그램을 간편하게 이식할 수 있다.

4. 프로그램을 작성하기 쉽다.

5. 프로그램을 깔끔하게 처리할 수 있다.

모든 선행처리기 문장은 반드시 선행처리 지시자인 #으로 시작해야 하며 끝에는 세미콜론(;)을 붙이지 않는다.

### 사용자 정의 헤더 파일
컴파일러가 제공하는 것 외에도 사용자가 필요에 따라 헤더 파일을 직접 정의하여 사용할 수 있다.

사용자 정의 헤더 파일을 정의할 때는 선행처리기 #define 명령어를 사용한다.

```c
// 사용자 정의 헤더파일 이름 myst.h
#pragma once // 컴파일 과정시 단 한번만 실행하라는 명령

#define SNO 202312345
#define NAME "홍길동"
#define AGE 23
'''
'''
#include <stdio.h>
#include "myst.h"

int main(void)
{
  printf("학번 : %d\n", SNO);
  printf("성명 : %s\n", NAME);
  printf("나이 : %d\n", AGE);
  return 0;
}
```
사용자 정의 헤더파일

사용자 정의 헤더 파일은 myst.h를 불러와 출력하는 프로그램이다.

소스코드와 동일한 위치에 존재하는 헤더 파일을 불러올 때는 큰따옴표로 헤더 파일을 묶어 #include "myst.h"와 같이 해야한다.

## 2. 매크로
매크로란 키보드나 마우스 조작 등의 단순 반복 기능을 한 번의 동작으로 자동 실행되도록 하는 기능을 말한다.

매크로는 자주 사용하는 여러 개의 명령어를 반복해서 사용할 때 유용하다.

### #define 명령어
선행처리기 명령어인 #define은 단순히 상수를 치환하는 것부터 매크로 함수를 정의하는 것까지 다양한 기능을 수행한다.

<pre>매크로 정의 선언 예시
<code>
#define SNO 202312345   // 정수형 상수 정의
#define NAME "홍길동"   // 문자형 상수 정의
#define PRINT printf("%c", op)    //실행문 정의
#define GOB(a) (a)*(a)    // 매크로 정의<code></pre>
#define 명령으로 정수형 상수와 문자형 상수, 실행문과 매크로에 대한 정의를 선언하여 사용할 수 있다.

```c
#include <stdio.h>

#define PI 3.141592       // 매크로 상수 정의
#define AREA PI * r * r   // 매크로 확장 두 번 발생

int main(void)
{
  float r;    // 변수 r을 반드시 사용해야 한다.(매크로 상수 정의)
  
  printf("반지름 입력 :");
  scanf_s("%f", &r);

  printf("원의 넓이 : %f\n", AREA);
  return 0;
}
```
매크로 상수 사용하여 원의 넓이 출력

파이 값과 원의 넓이를 구하는 공식을 각각 매크로 상수 PI와 AREA로 정의했다.

```c
#include<stdio.h>

#define swap1(a) (a * a)    // 매크로 함수 정의
#define swap2(a) ((a) * (a))    // 매개변수를 괄호로 처리

int main(void)
{
  int num;

  printf("정수 입력 : ");
  scanf_s("%d", &num);

  printf("괄호 없는 %d의 제곱근 %d\n", num, swap1(num));
  printf("괄호 있는 %d의 제곱근 %d\n\n", num, swap2(num));

  printf("괄호 없는 %d의 제곱근 %d\n", num, swap1(num + 5));
  printf("괄호 있는 %d의 제곱근 %d\n", num, swap2(num + 5));
  return 0;
}
```
매크로 함수로 제곱 구하기

예를 들어 키보드로 2의 값을 입력 받으면 (2 + 5 * 2 + 5)로 계산 되어서 17이 출력되고, 매개변수를 괄호로 묶어주면 ((2 + 5) * (2 + 5))로 계산 되어 49가 출력된다.

따라서 매크로 함수를 정의할 때 매개변수를 ()로 묶어야 정확한 결과값을 산출할 수 있다.

### 매크로 취소
이미 정의된 매크로를 취소할 때는 #undef 명령을 사용한다.

<pre>#undef 사용 예시
<code>
#define MAX 100 // 매크로 상수 정의
#undef MAX      // 매크로 상수 정의 취소
#define MAX 1000  // 매크로 상수 다시 정의 </code></pre>
#undef는 #define으로 정의한 매크로를 해제하는 선행처리기 명령이다.

```c
#include<stdio.h>

#define MAX 50  // 매크로 상수 정의

int main(void)
{
  int cnt, hap = 0;

  for (cnt = 1; cnt <= MAX; cnt ++)
      hap += cnt;

  printf("1부터 %d까지의 합 : %d\n", MAX, hap);

#undef MAX    // 매크로 상수 정의 취소
#define MAX 100   // 매크로 상수 다시 정의

  printf("매크로 취소 후 재정의 \n");

  hap = 0;
  for (cnt = 1; cnt <= MAx; cnt ++)
      hap += cnt;

  printf("1부터 %d까지의 합 : %d\n", MAX, hap);
  return 0;
}
```
매크로 취소 후 다시 정의

50으로 선언한 매크로를 취소하고, 100으로 재정의 했다.

#define 명령으로 이미 정의한 매크로를 #undef명령으로 해제하지 않고 매크로를 재정의하면 경고 메세지가 출력된다.